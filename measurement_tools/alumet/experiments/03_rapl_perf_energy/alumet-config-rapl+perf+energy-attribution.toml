[plugins.csv]
output_path = "alumet-output-rapl+perf+energy-attribution.csv"
force_flush = true
append_unit_to_metric_name = true
use_unit_display_name = true
csv_delimiter = ";"
csv_late_delimiter = ","

[plugins.rapl]
poll_interval = "20ms"
flush_interval = "2s"
no_perf_events = false

[plugins.perf]
poll_interval = "20ms"
flush_interval = "2s"
hardware_events = [ "CPU_CYCLES", "INSTRUCTIONS", "CACHE_REFERENCES", "CACHE_MISSES", "BRANCH_INSTRUCTIONS", "BRANCH_MISSES", "BUS_CYCLES", "REF_CPU_CYCLES",]
software_events = [ "PAGE_FAULTS", "CONTEXT_SWITCHES", "CPU_MIGRATIONS", "PAGE_FAULTS_MIN", "PAGE_FAULTS_MAJ", "ALIGNMENT_FAULTS", "EMULATION_FAULTS", "CGROUP_SWITCHES",]
cache_events = []

[plugins.procfs.kernel]
enabled = true
poll_interval = "20ms"

[plugins.procfs.memory]
enabled = true
poll_interval = "20ms"
metrics = [ "MemTotal", "MemFree", "MemAvailable", "Cached", "SwapCached", "Active", "Inactive", "Mapped",]

[plugins.procfs.network]
enabled = false
poll_interval = "20ms"

[plugins.procfs.processes]
enabled = true
refresh_interval = "20ms"
strategy = "event"
[[plugins.procfs.processes.groups]]
exe_regex = ""
poll_interval = "20ms"
flush_interval = "2s"
memory_mode = "quick"

[plugins.procfs.processes.events]
poll_interval = "20ms"
flush_interval = "2s"
memory_mode = "quick"

[plugins.energy-attribution.formulas.attributed_energy]
expr = "cpu_energy * cpu_usage / 100.0"
ref = "cpu_energy"
# The duration the measurement points are kept in memory before being dropped.
# This need to be coherent with the poll_interval of the metrics involved in this formula.
# Eg: If the metrics come from sources that poll every 1 second, it's recommanded to define the retention_time to at least 2 seconds.
# This way the plugin can make use of the precedent values of this metric to make interpolations.
retention_time = "50ms"

[plugins.energy-attribution.formulas.attributed_energy.per_resource.cpu_energy]
metric = "rapl_consumed_energy"
resource_kind = "local_machine"
domain = "package_total"

[plugins.energy-attribution.formulas.attributed_energy.per_consumer.cpu_usage]
metric = "cpu_percent"
kind = "total"
